(self.webpackChunkknowledge=self.webpackChunkknowledge||[]).push([[6935],{4452:(n,a,s)=>{"use strict";s.r(a),s.d(a,{data:()=>e});const e={key:"v-7f3cff5a",path:"/iOS/ApplicationExtensionUnavailable.html",title:"应用扩展不可用编译错误",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"问题描述",slug:"问题描述",children:[]},{level:2,title:"解决办法",slug:"解决办法",children:[{level:3,title:"Swift",slug:"swift",children:[]},{level:3,title:"OC",slug:"oc",children:[]}]}],filePathRelative:"iOS/ApplicationExtensionUnavailable.md",git:{updatedTime:1640341639e3,contributors:[]}}},7706:(n,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>m});var e=s(6252);const t=(0,e.Wm)("h1",{id:"应用扩展不可用编译错误",tabindex:"-1"},[(0,e.Wm)("a",{class:"header-anchor",href:"#应用扩展不可用编译错误","aria-hidden":"true"},"#"),(0,e.Uk)(" 应用扩展不可用编译错误")],-1),i=(0,e.Wm)("h2",{id:"问题描述",tabindex:"-1"},[(0,e.Wm)("a",{class:"header-anchor",href:"#问题描述","aria-hidden":"true"},"#"),(0,e.Uk)(" 问题描述")],-1),l=(0,e.Wm)("p",null,[(0,e.Uk)("在带有应用扩展的工程中，组件库内使用"),(0,e.Wm)("code",null,"UIApplication.shared"),(0,e.Uk)("，编译器报"),(0,e.Wm)("code",null,"'shared' is unavailable in application extensions for iOS: Use view controller based solutions where appropriate instead."),(0,e.Uk)("的错误")],-1),p=(0,e.Uk)("根据"),o={href:"https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/ExtensionOverview.html#//apple_ref/doc/uid/TP40014214-CH2-SW6",target:"_blank",rel:"noopener noreferrer"},c=(0,e.Uk)("App Extension Programming Guide "),r=(0,e.Uk)("，"),u=(0,e.Wm)("code",null,"UIApplication.shared",-1),d=(0,e.Uk)("以及其它使用"),h=(0,e.Wm)("code",null,"NS_EXTENSION_UNAVAILABLE",-1),k=(0,e.Uk)("标记的API在应用扩展中不可用"),b=(0,e.uE)('<h2 id="解决办法" tabindex="-1"><a class="header-anchor" href="#解决办法" aria-hidden="true">#</a> 解决办法</h2><p>为函数添加应用扩展不可用标记</p><p>函数默认是可以在应用扩展中调用的，这样在函数内部调用应用扩展不可用的API就会有问题。将函数标记为应用扩展不可用，可以类比将异常抛出，在用到应用扩展不可用的API的函数调用链的每一层全部加上应用扩展不可用标记，只要在应用扩展中不调用这些被标记的函数即可。换言之，被标记的函数在应用扩展中不可再被调用。</p><h3 id="swift" tabindex="-1"><a class="header-anchor" href="#swift" aria-hidden="true">#</a> Swift</h3><div class="language-swift ext-swift line-numbers-mode"><pre class="language-swift"><code>@<span class="token function">available</span><span class="token punctuation">(</span>iOSApplicationExtension<span class="token punctuation">,</span> unavailable<span class="token punctuation">)</span>\n<span class="token keyword">func</span> <span class="token function">methodUsedApplicationExtensionUnavailableAPI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token builtin">UIApplication</span><span class="token punctuation">.</span>shared\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="oc" tabindex="-1"><a class="header-anchor" href="#oc" aria-hidden="true">#</a> OC</h3><div class="language-objc ext-objc line-numbers-mode"><pre class="language-objc"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>methodUsedApplicationExtensionUnavailableAPI <span class="token function">NS_EXTENSION_UNAVAILABLE_IOS</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token punctuation">[</span>UIApplication sharedApplication<span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div>',7),m={render:function(n,a){const s=(0,e.up)("OutboundLink");return(0,e.wg)(),(0,e.j4)(e.HY,null,[t,i,l,(0,e.Wm)("p",null,[p,(0,e.Wm)("a",o,[c,(0,e.Wm)(s)]),r,u,d,h,k]),b],64)}}}}]);